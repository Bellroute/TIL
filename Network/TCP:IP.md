# TCP/IP

> 본 게시글은 https://youtu.be/NOFWq2mWeGA를 참고하여 작성되었습니다.



##  TCP/IP

인터넷은 네트워크의 네트워크다. 그 규모가 전 지구적이다보니 거대한 인터넷에서 연결하고 데이터를 주고 받기 위해서는 규약이 필요하다. 인터넷은 분산네트워크구조와 패킷 데이터 통신을 사용하기에 두 가지 측면에서 규약이 필요하다. (그것이 바로 TCP/IP)

우선, 분산네트워크구조를 유지하기 위한 프로토콜로 IP가 있다. 네트워크는 링크와 노드로 구성되어 있다. 정보통신네트워크에서는 각 노드가 원하는 노드를 탐색할 수 있어야한다. 이를 위해서는 특정 노드가 전체 노드에서 구별되는 유일한 노드임을 보장할 수 있어야한다. IP프로토콜은 네트워크에 참여한 노드를 유일하게 식별할 수 있도록 해줌으로써 네트워크 구조를 유지하고 원하는 노드를 찾을 수 있는 경로를 설정할 수 있게 도와준다.

이와 별도로 인터넷은 패킷 데이터 전송방식을 채택하고 있다. 패킷은 분산네트워크 환경에서 여러 경로를 통해 목적지에 도착한다. 이 패킷은 순서가 뒤바뀔 수도 있고, 훼손될 수도 있기 때문에 패킷의 흐름을 제어하기 위한 프로토콜이 필요하다. 그게 바로 TCP이다.



#### IP 프로토콜

- 원하는 노드를 식별하기 위한 프로토콜
- 전체 네트워크에서 식별가능한 IP 주소를 부여
- IP 주소를 이용해서 원하는 노드로의 경로를 설정
- 인터넷상의 거의 모든 응용이 IP를 기반으로 하고 있다.
- 노드와 노드 사이에서 경로를 설정하는 컴퓨터를 **라우터**라고 한다. (작게는 2개, 많게는 수십개의 라우터를 거친다.)



#### TCP

- 데이터 흐름을 제어하기 위한 프로토콜
- 데이터는 여러 패킷으로 조각 나서 이동한다.
- 패킷 통신은 네트워크를 효율적으로 활용 (데이터를 쪼개지 않고 통으로 보낸다면 데이터를 다 보낼 때까지 하나의 노드가 회선을 장악해 다른 노드는 네트워크에 참여할 수 없다. 데이터를 쪼갬으로써 여러 노드가 네트워크에 참여할 수 있도록 보장한다.)
- 네트워크 환경에 차이로 패킷은 순서대로 도착하지 않을 수 있고, 잡음으로 인해 데이터가 훼손될 수 있다. 이를 위해 TCP는 데이터 패킷에 대한 일련번호와 전송에 대한 응답이라는 두가지 매커니즘으로 데이터의 흐름을 제어한다.



#### OSI 7계층

인터넷은 하드웨어 인프라에서 데이터통신을 위한 소프트웨어까지 수많은 규약으로 이루어진 복잡한 시스템이다. 이 시스템에서 효과적인 응용 개발을 위해 OSI 7계층을 만들었다. 각 계층은 **하위 단계를 추상화**하기 때문에 해당 단계 개발자는 자신의 전문 계층의 지식으로만 원하는 애플리케이션 개발이 가능하다. (물론 다른 계층에 대한 일정 지식이 필요하지만 최소한의 이해만으로 개발이 가능하다는 점에서 효율적이다.)



#### TCP/IP 4계층

OSI 7계층은 지나치게 전문화되어있어 커뮤니케이션 비용에 따른 낭비가 발생한다는 단점이 있다. 이를 해결하기 위해 OSI 7계층의 몇개 계층을 통합해서 TCP/IP 4계층을 만들었다.







## 네트워크 프로그래밍

네트워크 프로그래밍은 TCP/IP 4계층의 응용 계층의 프로토콜을 이용해서 프로그램을 개발하는 과정을 의미한다. 이 프로토콜은 해당 프로그래밍 언어로 기술되어야하는데, 주요한 프로토콜의 대부분은 **소켓**에서 라이브러리 형태로 제공된다.

- 네트워크 프로그램은 TCP/IP 4계층의 각 단계의 커뮤니케이션 과정이다.

![image](https://user-images.githubusercontent.com/41420639/79959499-2bff6800-84bf-11ea-8ddd-6b744482e612.png)



#### Encapsulation

- 데이터는 각 단계를 거치면서, 커뮤니케이션할 프로토콜을 선택한다.
- 프로토콜을 선택했다면, 프로토콜을 만족하는 정보를 데이터 앞에 덧 붙인다.
- 인터넷으로 나갈 때까지 각 단계의 프로토콜 정보가 데이터에 덧 붙여진다.



#### 인터넷에서의 경로 설정

- 인터넷으로 나간 데이터는 라우터에 의해 경로가 설정된다.
- 라우터는 패킷의 IP헤더 정보를 읽어서, 목적지 주소를 알아내고 주변의 어떤 라우터로 보내야 할지를 결정한다.
- 이렇게 몇 개의 라우터를 거쳐서 최종 목적지에 도착한다.



#### Demultiplexing

- 목적지에 도착한 데이터는 encapsulation의 반대의 과정을 거쳐서 웹 서버까지 도착한다.
- 웹 서버는 HTTP 프로토콜 규격에 의거, 클라이언트의 요청을 확인하고 문서를 읽어서 데이터를 전송한다.



