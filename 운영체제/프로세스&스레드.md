# 프로세스&스레드

개발자 기술 면접 단골 질문이라는 **프로세스와 스레드의 차이**에 대해 알아보기 위해 프로세스와 스레드의 개념을 정리해보았다.





### 프로세스(Process)

프로그램은 디스크에 저장된 실행 가능한 명령어(instruction)의 집합이다. 그리고 **프로세스는 이러한 프로그램이 메모리에 적재(load)되어 실행중인 작업**을 의미한다. 프로그램을 실행하면 운영체제로부터 실행에 필요한 자원을 할당받아 프로세스가 된다. 이때, 각각의 프로세스는 서로 메모리 공간을 독자적으로 갖기 때문에 서로 메모리 공간을 공유하지 못한다. 다른 프로세스 메모리에 접근하려면 IPC(InterProcess Communication)과 같은 방식이 필요하다.

![image](https://user-images.githubusercontent.com/41420639/80282157-d7701d00-874a-11ea-8afb-fc3d1f82146e.png)

프로세스는 프로그램 실행시 Code, Data, Stack, Heap의 구조로 되어있는 독립된 메모리 영역을 할당 받는다.

- **Code(text)** : 프로그램의 실제 코드를 저장
- **Data** : 프로세스가 실행될 때 정의된 전역 변수, Static 변수들을 저장
- **Stack** : 함수에서 다른 함수를 실행하는 등의 서브루틴들의 정보를 저장
- **Heap** : 프로세스 런타임 중 동적으로 할당되는 변수들을 저장(함수 내에서 할당되는 변수 등)





#### 멀티 태스킹 vs 멀티 프로세싱

여러개의 프로세스를 동시에 실행하는 것을 멀티태스킹이라고 하고 어떤 작업을 하나이상의 프로세스에서 병렬로 처리하는 것을 멀티프로세싱이라고 한다.



**멀티 프로세싱**의 방식은 CPU에서 여러 프로세스를 로테이션으로 돌면서 처리하게 된다. 동작 중인 프로세스가 대기를 타면서 해당 프로세스의 상태(Context)를 보관하고, 대기하고 있던 다음 순번의 프로세스가 동작하면서 이전에 보관했던 프로세스의 상태(Context)를 복구하게 된다. 이러한 과정을 **Context Switching**이라고 하는데 프로세스는 각각 독립된 메모리 영역이다보니 **오버헤드가 발생**한다.





### 스레드(Thread)

**스레드는 프로세스 내에서 실행되는 여러 흐름의 단위**이다. 프로세스는 최소 1개 이상의 스레드를 갖는다. 스레드는 프로세스 내에서 실행되는 세부 작업 단위로 여러 개의 스레드가 하나의 프로세스를 이루게 된다. 스레드가 소속된 프로세스가 운영체제로부터 자원을 할당받으면 그 자원을 스레드가 사용한다. 

![image](https://user-images.githubusercontent.com/41420639/80282252-6c731600-874b-11ea-96e7-458f46563cc5.png)

스레드는 프로세스 내에서 각각 Stack만 따로 할당을 받고 Code, Data, Heap영역을 공유한다. 이러한 특징 때문에 스레드는 다음과 같은 장점을 갖는다.

- 프로세스 간 통신에 비해 스레드 간 통신이 훨씬 간단하다. (서로 공유하는 변수를변경하기만 하면 되기 때문)
- 시스템의 자원 소모가 줄어든다.(기존 프로세스의 자원을 공유하기 때문에 자원을 새로 할당하지 않아도 된다.)
- 전체 응답 시간이 단축된다. (Context Switching 과정에서 오버헤드가 줄어들어 전체 응답이 짧아진다.)

하지만 여러 스레드가 동시에 작업을 하다보면 공유된 데이터를 서로 사용하다가 충돌이 일어날 가능성이 크다. 또한 개발시 디버깅도 까다로워 버그가 생성될 가능성이 증가한다. 때문에 Thread-safe하도록 구현하는 것이 중요하다.





### 결론: 프로세스 vs 스레드

프로세스는 운영체제로부터 자원을 할당받는다. 각 작업마다 운영체제로부터 자원을 할당받기 위해 시스템 콜(Call)을 하는 부담이 생긴다. 멀티 스레드를 사용한다면 시스템 콜을 한번만 해도 되기 때문에 효율적이다. 또한 IPC 방식보다는 스레드 간 통신이 덜 복잡하고 시스템 자원 사용이 더 적으므로 통신의 부담도 줄일 수 있다. 스레드 간 동기화 문제가 생겨 개발자가 신경써야 하는 단점이 있지만 작업의 비용을 줄인다는 장점이 있다.



#### [참고]

> - [프로세스(Process)와 스레드(Thread)의 차이](https://gbsb.tistory.com/312)
> - [process와 thread에 대한 정리](https://magi82.github.io/process-thread/)
> - [프로세스와 쓰레드의 차이](https://juyoung-1008.tistory.com/47)
> - [Process와 Thread의 차이](https://shoark7.github.io/programming/knowledge/difference-between-process-and-thread)